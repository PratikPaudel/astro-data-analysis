import numpy as np
import matplotlib.pyplot as plt

# Eddington ratio analysis
eddington_ratios = np.array([0.00286,0.00289,0.00289,0.00289,0.00289,0.00289,0.00289,0.00291,0.00294,0.00299,
                             0.00304,0.00304,0.00310,0.00310,0.00315,0.00323,0.00332,0.00338,0.00349,0.00362,
                             0.00378,0.00387,0.00408,0.00441,0.00477,0.00515,0.00542,0.00552,0.00571,0.00607,
                             0.00673,0.00759,0.00807,0.00895,0.00992,0.01091,0.01189,0.01426,0.01680,0.01912,
                             0.02120,0.02413,0.02843,0.03208,0.03879,0.04896,0.05818,0.06855,0.08006,0.10020,
                             0.12010,0.15160,0.17555,0.21042,0.24157,0.27494,0.29972,0.34112,0.39162,0.42324,
                             0.46138,0.51170,0.59254,0.65153,0.72886,0.82243,0.90430])

extinctions = np.array([19.51575,19.60236,19.68504,19.74016,19.77559,19.81496,19.86614,19.96063,20.05118,
                        20.10236,20.18504,20.25591,20.30709,20.35827,20.39764,20.48819,20.54725,20.58661,
                        20.64567,20.70079,20.78740,20.86221,20.93307,21.01969,21.09842,21.14961,21.19291,
                        21.23228,21.27165,21.29527,21.39370,21.48031,21.52756,21.57087,21.63779,21.68504,
                        21.73622,21.81890,21.91732,21.98031,22.03937,22.10236,22.17717,22.23228,22.31496,
                        22.43701,22.51575,22.60236,22.66929,22.77953,22.87795,22.99213,23.05118,23.14567,
                        23.21260,23.26772,23.31496,23.39764,23.45669,23.50787,23.57874,23.63779,23.72047,
                        23.78740,23.84646,23.91339,23.98031])

# Create scatter plot
plt.figure(figsize=(10, 6))
plt.scatter(np.log10(eddington_ratios), np.log10(extinctions),
            color='b', marker='o', label='Data points')

plt.title('Extinction vs Eddington Ratio')
plt.xlabel(r'log f$_{\text{ Edd}}$')
plt.ylabel('log E(B-V) (mag)')
plt.xlim(-3, 1)
plt.grid(True)
plt.legend()
plt.tight_layout()
plt.show()

# Additional analysis: Calculate correlation coefficient
correlation = np.corrcoef(np.log10(eddington_ratios), np.log10(extinctions))[0,1]
print(f"Correlation coefficient: {correlation:.3f}")